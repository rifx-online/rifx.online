---
import config from "@/config/config.json";
import dateFormat from "@/lib/utils/dateFormat";
import {
  getLangFromUrl,
  getTranslations,
  slugSelector,
} from "@/lib/utils/languageParser";
import { humanize, plainify, slugify } from "@/lib/utils/textConverter";
import type { ContentEntryMap } from "astro:content";
import { FaRegFolder, FaRegUserCircle } from "react-icons/fa";
import ImageMod from "./ImageMod.astro";

const { summary_length }: { summary_length: number; model_folder: string } =
  config.settings;
const { data } = Astro.props;
const { title, id, context, input, output, description, image, categories, date, author } = data.data;

const lang = getLangFromUrl(Astro.url);
const { read_more } = await getTranslations(lang as keyof ContentEntryMap);

const slugParts = data.slug.split("/");
slugParts[0] = "models";
const modifiedSlug = slugParts.join("/");
data.slug = modifiedSlug;
---

<div class="bg-body dark:bg-darkmode-body p-6 rounded-lg shadow-md">
  <h3 class="text-2xl font-semibold mb-1">{title}</h3>
  <div class="flex items-center mb-3">
    <span class="text-gray-500 mr-2">{id}</span>
    <!-- 这里可以添加复制按钮,如果需要的话 -->
  </div>
  
  <p class="text-lg text-gray-600 mb-4">{plainify(data.body?.slice(0, Number(summary_length)))}...</p>
  
  <div class="text-sm text-gray-500 flex flex-wrap gap-x-6 gap-y-2 mb-4">
    <span><a href={slugSelector(`/authors/${slugify(author)}`, lang)}>
        <FaRegUserCircle className={"mr-2 -mt-1 inline-block"} />
        {humanize(author)}
      </a></span>
    <span><strong>Context:</strong> {context}</span>
    <span><strong>Input:</strong> ${input}/1K tokens</span>
    <span><strong>Output:</strong> ${output}/1K tokens</span>
    <span><FaRegFolder className={"mr-2 -mt-1 inline-block"} />
        {
          categories.map((category: string, index: number) => (
            <a href={slugSelector(`/categories/${slugify(category)}`, lang)}>
              {humanize(category)}
              {index !== categories.length - 1 && ","}
            </a>
          ))
        }</span>
  </div>

  <!-- {image && (
    <ImageMod
      class="mb-6 w-full rounded"
      src={image}
      alt={title}
      width={445}
      height={230}
      format="webp"
    />
  )} -->


</div>
